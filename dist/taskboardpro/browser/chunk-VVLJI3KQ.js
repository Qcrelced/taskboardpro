import{a as C,b as Z,c as ee,f as te,i as ie}from"./chunk-VPQW6KE7.js";import{g as Y}from"./chunk-QFQ4WHJE.js";import{$a as j,G as Q,Ia as H,Ja as W,Ka as q,L as c,La as y,Ma as I,Oa as _,Pa as g,Q as d,R as p,Ra as s,Sa as o,Ta as b,Ua as P,Va as O,Wa as V,Xa as k,Ya as T,_a as z,ab as M,bb as N,cb as G,e as B,eb as r,fb as J,gb as $,hb as D,jb as K,kb as U,la as m,lb as X,ob as F,pb as A,ta as w,wa as u}from"./chunk-S5YNJ5TN.js";import{a as E,b as v}from"./chunk-2NFLSA4Y.js";var h=class n{memberService=c(C);tasksSubject=new B([]);tasks$=this.tasksSubject.asObservable();addTask(t,e){let i;e&&this.memberService.members$.subscribe(l=>{i=l.find(f=>f.id===e)}).unsubscribe();let a={id:Date.now(),title:t,completed:!1,owner:i};this.tasksSubject.next([...this.tasksSubject.value,a])}deleteTask(t){let e=this.tasksSubject.value.filter(i=>i.id!==t);this.tasksSubject.next(e)}toggleTask(t){let e=this.tasksSubject.value.map(i=>i.id===t?v(E({},i),{completed:!i.completed}):i);this.tasksSubject.next(e)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var S=class n{title="";static \u0275fac=function(e){return new(e||n)};static \u0275cmp=u({type:n,selectors:[["app-task-highlight"]],inputs:{title:"title"},decls:5,vars:1,template:function(e,i){e&1&&(s(0,"div")(1,"h3"),r(2,"T\xE2che mise en avant"),o(),s(3,"p"),r(4),o()()),e&2&&(m(4),J(i.title))},encapsulation:2})};var x=class n{task;container;taskService=c(h);title;ngOnInit(){this.title=this.task.title}save(){let t=this.title.trim();if(!t)return;let e=this.taskService.tasksSubject.value.map(i=>i.id===this.task.id?v(E({},i),{title:t}):i);this.taskService.tasksSubject.next(e),this.container&&this.container.clear()}cancel(){this.container&&this.container.clear()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=u({type:n,selectors:[["app-task-edit"]],inputs:{task:"task",container:"container"},decls:8,vars:1,consts:[[1,"task-edit"],["placeholder","Titre de la t\xE2che",3,"ngModelChange","ngModel"],[3,"click"]],template:function(e,i){e&1&&(_(0,"div",0)(1,"h3"),r(2,"\xC9diter la t\xE2che"),g(),_(3,"input",1),X("ngModelChange",function(l){return U(i.title,l)||(i.title=l),l}),g(),_(4,"button",2),V("click",function(){return i.save()}),r(5,"Enregistrer"),g(),_(6,"button",2),V("click",function(){return i.cancel()}),r(7,"Annuler"),g()()),e&2&&(m(3),K("ngModel",i.title))},dependencies:[ie,Z,ee,te],encapsulation:2})};var se=["highlightContainer"],oe=["editContainer"],re=(n,t)=>t.id;function le(n,t){if(n&1){let e=P();s(0,"li"),r(1),s(2,"small"),r(3),o(),s(4,"button",9),k("click",function(){let a=d(e).$implicit,l=T(2);return p(l.highlight(a))}),r(5,"Mettre en avant"),o(),s(6,"button",9),k("click",function(){let a=d(e).$implicit,l=T(2);return p(l.toggleTask(a.id))}),r(7),o(),s(8,"button",9),k("click",function(){let a=d(e).$implicit,l=T(2);return p(l.editTask(a))}),r(9,"\xC9diter"),o(),s(10,"button",9),k("click",function(a){let l=d(e).$implicit;return T(2).deleteTask(l.id),p(a.stopPropagation())}),r(11," Supprimer "),o()()}if(n&2){let e=t.$implicit;G("text-decoration",e.completed?"line-through":"none"),m(),$(" ",e.title," "),m(2),D("(Membre: ",e.owner==null?null:e.owner.firstName," ",e.owner==null?null:e.owner.lastName,")"),m(4),$(" ",e.completed?"Annuler":"Terminer"," ")}}function me(n,t){n&1&&(s(0,"ul"),y(1,le,12,6,"li",8,re),o()),n&2&&(m(),I(t))}function ce(n,t){n&1&&(s(0,"p"),r(1,"Chargement des t\xE2ches..."),o())}function de(n,t){if(n&1&&(s(0,"option",6),r(1),o()),n&2){let e=t.$implicit;O("value",e.id),m(),D("",e.firstName," ",e.lastName)}}var ae=class n{taskService=c(h);memberService=c(C);tasks$=this.taskService.tasks$;members$=this.memberService.members$;highlightContainer;editContainer;addTask(t,e){if(t.trim()){let i=e?parseInt(e,10):void 0;this.taskService.addTask(t,i)}}deleteTask(t){this.taskService.deleteTask(t)}toggleTask(t){this.taskService.toggleTask(t)}highlight(t){if(!this.highlightContainer)return;this.highlightContainer.clear();let e=this.highlightContainer.createComponent(S);e.instance.title=t.title}editTask(t){if(!this.editContainer)return;this.editContainer.clear();let e=this.editContainer.createComponent(x);e.instance.task=t,e.instance.container=this.editContainer}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=u({type:n,selectors:[["app-tasks-page"]],viewQuery:function(e,i){if(e&1&&z(se,5,w)(oe,5,w),e&2){let a;j(a=M())&&(i.highlightContainer=a.first),j(a=M())&&(i.editContainer=a.first)}},decls:23,vars:5,consts:[["taskInput",""],["memberSelect",""],["highlightContainer",""],["editContainer",""],["placeholder","Nouvelle t\xE2che"],["value",""],[3,"value"],[3,"click"],[3,"text-decoration"],["type","button",3,"click"]],template:function(e,i){if(e&1){let a=P();s(0,"h2"),r(1,"Liste des t\xE2ches"),o(),H(2,me,3,0,"ul"),F(3,"async"),W(4,ce,2,0,"p"),b(5,"hr"),s(6,"h3"),r(7,"Actions"),o(),b(8,"input",4,0),s(10,"select",null,1)(12,"option",5),r(13,"-- Attribuer \xE0 --"),o(),y(14,de,2,3,"option",6,re),F(16,"async"),o(),s(17,"button",7),k("click",function(){d(a);let f=N(9),R=N(11);return i.addTask(f.value,R.value),f.value="",p(R.value="")}),r(18,` Ajouter une t\xE2che
`),o(),b(19,"div",null,2)(21,"div",null,3)}if(e&2){let a;m(2),q((a=A(3,1,i.tasks$))?2:4,a),m(12),I(A(16,3,i.members$))}},dependencies:[Y],encapsulation:2})};export{ae as TasksPage};
